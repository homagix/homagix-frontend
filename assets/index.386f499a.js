var Z=Object.defineProperty,W=Object.defineProperties;var q=Object.getOwnPropertyDescriptors;var N=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var T=(t,e,s)=>e in t?Z(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,k=(t,e)=>{for(var s in e||(e={}))K.call(e,s)&&T(t,s,e[s]);if(N)for(var s of N(e))J.call(e,s)&&T(t,s,e[s]);return t},U=(t,e)=>W(t,q(e));import{o as Q,a as u,c as _,r as X,d as $,u as S,b as F,e as o,w as Y,v as ee,f as d,i as te,g as h,h as f,F as v,j as p,k as E,l as ne,m as se,n as I,p as z,q as oe,t as b,s as L,x as re,y as P,z as ie,A as ae,B as ce,C as ue,D as le,E as _e,O as de,G as pe}from"./vendor.0e239747.js";const he=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function s(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerpolicy&&(i.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?i.credentials="include":n.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(n){if(n.ep)return;n.ep=!0;const i=s(n);fetch(n.href,i)}};he();function me(t=7200){return e=>{document.cookie=`token=${e};path=/homagix-frontend/;max-age=${e?t:-1}`}}function fe(t){return e=>t(e?`Bearer ${e}`:void 0)}function ge(t){return e=>{if(e){const{sub:s,firstName:r,accessCode:n}=Q(e);t.commit(y.SET_USER,{id:s,name:r,accessCode:n})}else t.commit(y.SET_USER,null)}}var w=(t,e)=>{const s=t.__vccOpts||t;for(const[r,n]of e)s[r]=n;return s};const ve={};function ye(t,e){return u(),_("button",null,[X(t.$slots,"default",{},void 0,!0)])}var R=w(ve,[["render",ye],["__scopeId","data-v-4e04e4f1"]]);const be=o("h2",null,"Neu registrieren",-1),$e=o("p",null," Hier kannst du deinem Zugang einen Namen (z.B. deinen Vornamen oder auch einen Phantasienamen) geben. Wir sprechen dich dann k\xFCnftig damit an. ",-1),ke=p(" Name "),Ee={class:"button-list"},Re=p("Registrieren"),Se=p("Abbrechen"),Ce=$({setup(t){const e=S(),s=D();let r=F("");async function n(){await s.dispatch(C.REGISTER_USER,r.value),e.push("/my")}function i(){e.back()}return(c,l)=>(u(),_(v,null,[be,$e,o("label",null,[ke,Y(o("input",{type:"text","onUpdate:modelValue":l[0]||(l[0]=a=>te(r)?r.value=a:r=a)},null,512),[[ee,d(r)]])]),o("div",Ee,[h(R,{id:"register-button",onClick:n},{default:f(()=>[Re]),_:1}),h(R,{id:"cancel-button",onClick:i},{default:f(()=>[Se]),_:1})])],64))}});const we=o("h2",null,"Willkommen!",-1),xe=o("p",null," Du bist bereits registriert? Um deine Daten zu sch\xFCtzen, musst du den Bookmark verwenden, den du nach der Registrierung erhalten hast. ",-1),De=p("Du willst dich neu registrieren? Dann geht's "),Oe=p("hier entlang"),Le={class:"button-list"},Ie=p("Abbrechen"),Ae=$({setup(t){const e=S();return(s,r)=>{const n=E("router-link");return u(),_(v,null,[we,xe,o("p",null,[De,h(n,{to:"/register"},{default:f(()=>[Oe]),_:1})]),o("div",Le,[h(R,{onClick:d(e).back},{default:f(()=>[Ie]),_:1},8,["onClick"])])],64)}}});const Ne=o("h2",null,"Ciao!",-1),Te=o("p",null,"Wir hoffen, Dich bald wiederzusehen!",-1),Ue={class:"button-list"},ze=p("Zu den Rezepten"),Be=$({setup(t){const e=S();return(s,r)=>(u(),_(v,null,[Ne,Te,o("div",Ue,[h(R,{id:"recipes-button",onClick:r[0]||(r[0]=n=>d(e).push("/recipes"))},{default:f(()=>[ze]),_:1})])],64))}}),Fe=o("h2",null,"Dein Zugang",-1),Pe=o("p",null," Speichere diese Seite als Bookmark oder Favorit, dann kommst du einfach wieder hierher zur\xFCck, ohne dich einloggen zu m\xFCssen. ",-1),He=o("p",null,"Da jede:r mit dem Bookmark hierher kommt, solltest du diesen Link nicht an andere weiter geben.",-1),je={class:"button-list"},Ge=p("Zu den Rezepten"),Me=$({setup(t){const e=S();function s(){e.push("/recipes")}return(r,n)=>(u(),_(v,null,[Fe,Pe,He,o("div",je,[h(R,{id:"recipes-button",onClick:s},{default:f(()=>[Ge]),_:1})])],64))}}),H=localStorage.getItem("basePath")||"https://homagix-server.dilab.co";function Ve(t){return H+"/images/"+t}const A={"Content-Type":"application/json"};function Ze(t){t?A.Authorization=t:delete A.Authorization}async function x(t,e,s={},r={}){var c;r.headers=k(k({},A),r.headers||{}),["post","put","patch"].includes(t.toLowerCase())&&Object.keys(s).length?r.body=JSON.stringify(s):Object.keys(s).length&&(e+=`?${new URLSearchParams(s).toString()}`),r.method=t;const n=await fetch(H+e,r),i=(c=n.headers.get("content-type"))!=null&&c.match(/json/)?await n.json():await n.text();if(!n.ok){const l={message:`${t} ${e} -> ${n.status}`,details:{request:`${t} ${e}`,status:n.status,content:i}};throw console.error(l),l}return i}async function We(t){return await x("post","/accounts",{firstName:t})}async function qe(t,e){return await x("get","/accounts/"+t+"/access-codes/"+e)}async function Ke(){return await x("delete","/session")}function Je(t,e=[]){function s(){const a=document.cookie.match(/token=([\w.]+)/);e.forEach(m=>m(a?a[1]:void 0))}function r(){e.forEach(a=>a())}async function n(a){try{const{token:m}=await qe(a.params.id,a.params.code);if(m)return e.forEach(g=>g(m)),!0}catch(m){console.error(m)}return"/login"}function i(){const a=t();return a?"/user/"+a.id+"/"+a.accessCode:"/login"}const c=[{path:"/register",component:Ce},{path:"/login",component:Ae},{path:"/logout",component:Be,beforeEnter:r},{path:"/user/:id/:code",component:Me,beforeEnter:n},{path:"/my",redirect:i}];function l(){t()||s()}return{routes:c,beforeEach:l}}const Qe={user:null},Xe={SET_USER(t,e){t.user=e}};var j=k({SET_ERROR(t,e){t.error=e},LOADED_DISHES(t,e){t.dishes=e.dishes},LOADED_INGREDIENTS(t,e){t.ingredients=e.ingredients}},Xe);async function Ye(){return await x("get","/dishes")}async function et(){return await x("get","/ingredients")}function O(t,e){return async(s,...r)=>{try{await t(s,...r)}catch(n){s.dispatch(C.ERROR_OCCURED,{message:e,details:n})}}}var G={ERROR_OCCURED(t,e){t.commit(y.SET_ERROR,e)},CLEAR_ERROR(t){t.commit(y.SET_ERROR,null)},LOAD_DISHES:O(async t=>t.commit(y.LOADED_DISHES,await Ye()),"Rezepte konnten nicht geladen werden"),LOAD_INGREDIENTS:O(async t=>t.commit(y.LOADED_INGREDIENTS,await et()),"Zutaten konnten nicht geladen werden"),REGISTER_USER:O(async(t,e)=>t.commit(y.SET_USER,await We(e)),"Die Registrierung war leider nicht erfolgreich. Bitte noch einmal probieren!"),LOGOUT:O(async t=>{await Ke(),t.commit(y.SET_USER,null)},"Logout fehlgeschlagen")},tt={};const nt=k({error:null,dishes:[],ingredients:[]},Qe),B=ne({strict:{}.NODE_ENV!=="production",state:nt,mutations:j,actions:G,getters:tt});function M(t){return Object.assign({},...Object.keys(t).map(e=>({[e]:e})))}const y=M(j),C=M(G);function D(){return se()}const st={class:"navbar-start"},ot=p(" Recipes "),rt={class:"navbar-end"},it={class:"navbar-item"},at={class:"buttons"},ct=p(" Registrieren "),ut=p("Abmelden"),lt=$({props:{open:null},setup(t){const e=t,s=D(),r=I(()=>"navbar-menu"+(e.open?" is-active":""));return(n,i)=>{const c=E("router-link");return u(),_("div",{id:"navbar",class:oe(d(r))},[o("div",st,[h(c,{class:"navbar-item",to:"/recipes"},{default:f(()=>[ot]),_:1})]),o("div",rt,[o("div",it,[o("div",at,[d(s).state.user?(u(),z(c,{key:1,to:"/logout",class:"button is-light"},{default:f(()=>[ut]),_:1})):(u(),z(c,{key:0,to:"/register",class:"button is-primary"},{default:f(()=>[ct]),_:1}))])])])],2)}}});var _t=w(lt,[["__scopeId","data-v-40eac8f2"]]);const dt={class:"navbar-brand"},pt=o("h1",{class:"title"},"Homagix",-1),ht={key:0,class:"username"},mt=["onClick"],ft=o("span",{"aria-hidden":"true"},null,-1),gt=o("span",{"aria-hidden":"true"},null,-1),vt=o("span",{"aria-hidden":"true"},null,-1),yt=[ft,gt,vt],bt={key:0,class:"error-container"},$t=$({setup(t){const e=D(),s=I(()=>e==null?void 0:e.state.error),r=F(!1);e.dispatch(C.LOAD_DISHES),e.dispatch(C.LOAD_INGREDIENTS);function n(){e.dispatch(C.CLEAR_ERROR)}function i(l){l.target&&(r.value=!r.value)}function c(){r.value=!1}return(l,a)=>{const m=E("router-link"),g=E("router-view");return u(),_(v,null,[o("nav",{class:"navbar is-warning",role:"navigation","aria-label":"main navigation",onClick:c},[o("div",dt,[h(m,{to:"/",class:"navbar-item"},{default:f(()=>[pt]),_:1}),d(e).state.user?(u(),_("div",ht,b(d(e).state.user.name),1)):L("",!0),o("a",{role:"button",class:"navbar-burger","aria-label":"menu","aria-expanded":"false",onClick:re(i,["stop"])},yt,8,mt)]),h(_t,{open:r.value},null,8,["open"])]),d(s)?(u(),_("div",bt,[o("span",{onClick:n},"\xD7"),p(" "+b(d(s).message),1)])):L("",!0),o("section",{class:"section",onClick:c},[h(g)])],64)}}});const kt=t=>(ie("data-v-71246241"),t=t(),ae(),t),Et=kt(()=>o("div",{class:"title is-4"},"Rezepte",-1)),Rt={id:"recipes-list"},St=["onClick"],Ct=$({setup(t){const e=D(),s=S(),r=I(()=>{var c;const i=(c=e.state.dishes)==null?void 0:c.filter(l=>!l.alwaysOnList);return i==null?void 0:i.sort((l,a)=>l.name.localeCompare(a.name))});function n(i){s.push({name:"recipe",params:{id:i}})}return(i,c)=>{const l=E("o-icon");return u(),_(v,null,[Et,o("ul",Rt,[(u(!0),_(v,null,P(d(r),a=>(u(),_("li",{key:a.id,onClick:()=>n(a.id)},[h(l,{icon:"utensils"}),p(" "+b(a.name),1)],8,St))),128))])],64)}}});var wt=w(Ct,[["__scopeId","data-v-71246241"]]);const xt={key:0},Dt={class:"title is-4"},Ot=["src"],Lt={class:"wrapper",id:"ingredient-list"},It={class:"number"},At=p("Zur\xFCck"),Nt=$({setup(t){const e=D(),s=ce(),r=S(),n=I(()=>e.state.dishes.find(a=>a.id===s.params.id));function i(){var a;return(a=n.value)==null?void 0:a.items.map(m=>{var g;return U(k({},(g=e.state.ingredients)==null?void 0:g.find(V=>V.id===m.id)),{amount:m.amount})})}function c(){r.push({name:"recipes"})}function l(a){return Ve(a.image)}return(a,m)=>d(n)?(u(),_("section",xt,[o("div",Dt,b(d(n).name),1),d(n).image?(u(),_("img",{key:0,src:l(d(n))},null,8,Ot)):L("",!0),o("div",Lt,[(u(!0),_(v,null,P(i(),g=>(u(),_(v,{key:g.id},[o("span",It,b(g.amount),1),o("span",null,b(g.unit),1),o("span",null,b(g.name),1)],64))),128))]),o("p",null,b(d(n).recipe),1),h(R,{onClick:c},{default:f(()=>[At]),_:1})])):L("",!0)}});var Tt=w(Nt,[["__scopeId","data-v-43dbb0a0"]]);const Ut={},zt=o("div",{class:"title is-4"},"Hast du dich verirrt?",-1),Bt=o("p",null,"Die angeforderte Seite existiert leider nicht.",-1),Ft=p("Bring mich in Sicherheit!");function Pt(t,e){const s=E("router-link");return u(),_(v,null,[zt,Bt,h(s,{to:"/"},{default:f(()=>[Ft]),_:1})],64)}var Ht=w(Ut,[["render",Pt]]),jt=t=>{const e=Je(()=>t.state.user,[me(7200),fe(Ze),ge(t)]),s=ue({history:le("/homagix-frontend/"),routes:[{name:"home",path:"/",redirect:"/recipes"},{name:"recipes",path:"/recipes",component:wt},{name:"recipe",path:"/recipes/:id",component:Tt},...e.routes,{path:"/:pathMatch(.*)*",component:Ht}]});return s.beforeEach(e.beforeEach),s};_e($t).use(B).use(jt(B)).use(de,k({customIconPacks:{fas:{sizes:{default:"",small:"fa-sm",medium:"fa-lg",large:"fa-2x"}}},iconPack:"fas"},pe.exports.bulmaConfig)).mount("#app");
