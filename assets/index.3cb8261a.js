var K=Object.defineProperty,J=Object.defineProperties;var Q=Object.getOwnPropertyDescriptors;var U=Object.getOwnPropertySymbols;var X=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var L=(t,e,n)=>e in t?K(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,E=(t,e)=>{for(var n in e||(e={}))X.call(e,n)&&L(t,n,e[n]);if(U)for(var n of U(e))Y.call(e,n)&&L(t,n,e[n]);return t},z=(t,e)=>J(t,Q(e));var B=(t,e,n)=>(L(t,typeof e!="symbol"?e+"":e,n),n);import{o as ee,a as u,c as _,r as te,d as b,u as S,b as F,e as r,w as ne,v as se,f as l,i as oe,g as h,h as m,F as v,j as p,k as $,l as re,m as ie,n as D,p as T,q as ae,t as k,s as A,x as ce,y as H,z as ue,A as le,B as _e,C as de,D as pe,E as he,O as me,G as fe}from"./vendor.0e239747.js";const ge=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}};ge();function ve(t=7200){return e=>{document.cookie=`token=${e};path=/homagix-frontend/;max-age=${e?t:-1}`}}function ye(t){return e=>t(e?`Bearer ${e}`:void 0)}function ke(t){return e=>{if(e){const{sub:n,firstName:o,accessCode:s}=ee(e);t.commit(g.SET_USER,{id:n,name:o,accessCode:s})}else t.commit(g.SET_USER,null)}}var C=(t,e)=>{const n=t.__vccOpts||t;for(const[o,s]of e)n[o]=s;return n};const be={};function Ee(t,e){return u(),_("button",null,[te(t.$slots,"default",{},void 0,!0)])}var R=C(be,[["render",Ee],["__scopeId","data-v-4e04e4f1"]]);const $e=r("h2",{class:"title is-4"},"Neu registrieren",-1),Re=r("p",null," Hier kannst du deinem Zugang einen Namen (z.B. deinen Vornamen oder auch einen Phantasienamen) geben. Wir sprechen dich dann k\xFCnftig damit an. ",-1),Se=p(" Name "),Ce={class:"button-list"},xe=p("Registrieren"),we=p("Abbrechen"),De=b({setup(t){const e=S(),n=x();let o=F("");async function s(){await n.dispatch(w.REGISTER_USER,o.value),e.push("/my")}function i(){e.back()}return(c,d)=>(u(),_(v,null,[$e,Re,r("label",null,[Se,ne(r("input",{type:"text","onUpdate:modelValue":d[0]||(d[0]=a=>oe(o)?o.value=a:o=a)},null,512),[[se,l(o)]])]),r("div",Ce,[h(R,{id:"register-button",onClick:s},{default:m(()=>[xe]),_:1}),h(R,{id:"cancel-button",onClick:i},{default:m(()=>[we]),_:1})])],64))}});const Oe=r("h2",{class:"title is-4"},"Willkommen!",-1),Ie=r("p",null," Du bist bereits registriert? Um deine Daten zu sch\xFCtzen, musst du den Bookmark verwenden, den du nach der Registrierung erhalten hast. ",-1),Ae=p("Du willst dich neu registrieren? Dann geht's "),Le=p("hier entlang"),Te={class:"button-list"},Ne=p("Abbrechen"),Ue=b({setup(t){const e=S();return(n,o)=>{const s=$("router-link");return u(),_(v,null,[Oe,Ie,r("p",null,[Ae,h(s,{to:"/register"},{default:m(()=>[Le]),_:1})]),r("div",Te,[h(R,{onClick:l(e).back},{default:m(()=>[Ne]),_:1},8,["onClick"])])],64)}}});const ze=r("h2",{class:"title is-4"},"Ciao!",-1),Be=r("p",null,"Wir hoffen, Dich bald wiederzusehen!",-1),Pe={class:"button-list"},Fe=p("Zu den Rezepten"),He=b({setup(t){const e=S();return(n,o)=>(u(),_(v,null,[ze,Be,r("div",Pe,[h(R,{id:"recipes-button",onClick:o[0]||(o[0]=s=>l(e).push("/recipes"))},{default:m(()=>[Fe]),_:1})])],64))}}),je=r("h2",{class:"title is-4"},"Dein Zugang",-1),Me=r("p",null," Speichere diese Seite als Bookmark oder Favorit, dann kommst du einfach wieder hierher zur\xFCck, ohne dich einloggen zu m\xFCssen. ",-1),Ge=r("p",null,"Da jede:r mit dem Bookmark hierher kommt, solltest du diesen Link nicht an andere weiter geben.",-1),Ve={class:"button-list"},Ze=p("Zu den Rezepten"),We=b({setup(t){const e=S();function n(){e.push("/recipes")}return(o,s)=>(u(),_(v,null,[je,Me,Ge,r("div",Ve,[h(R,{id:"recipes-button",onClick:n},{default:m(()=>[Ze]),_:1})])],64))}}),j=localStorage.getItem("basePath")||"https://homagix-server.dilab.co";class M extends Error{constructor(e,n){super(e);B(this,"details");this.details=n}}class G extends M{constructor(){super("Missing authentication token",{status:401})}}function qe(t){return j+"/images/"+t}const N={"Content-Type":"application/json"};function Ke(t){t?N.Authorization=t:delete N.Authorization}async function O(t,e,n={},o={}){var c;o.headers=E(E({},N),o.headers||{}),o.method=t.toUpperCase(),["POST","PUT","PATCH"].includes(o.method)&&Object.keys(n).length?o.body=JSON.stringify(n):Object.keys(n).length&&(e+=`?${new URLSearchParams(n).toString()}`);const s=await fetch(j+e,o),i=(c=s.headers.get("content-type"))!=null&&c.match(/json/)?await s.json():await s.text();if(!s.ok){if(s.status===401)throw new G;const d=new M(`${t} ${e} -> ${s.status}`,{status:s.status,content:i});throw console.error(d),d}return i}async function Je(t){return await O("post","/accounts",{firstName:t})}async function Qe(t,e){return await O("get","/accounts/"+t+"/access-codes/"+e)}async function Xe(){return await O("delete","/session")}function Ye(t,e=[]){function n(){const a=document.cookie.match(/token=([\w.]+)/);e.forEach(f=>f(a?a[1]:void 0))}function o(){e.forEach(a=>a())}async function s(a){try{const{token:f}=await Qe(a.params.id,a.params.code);if(f)return e.forEach(y=>y(f)),!0}catch(f){console.error(f)}return"/login"}function i(){const a=t();return a?"/user/"+a.id+"/"+a.accessCode:"/login"}const c=[{path:"/register",component:De},{path:"/login",component:Ue},{path:"/logout",component:He,beforeEnter:o},{path:"/user/:id/:code",component:We,beforeEnter:s},{path:"/my",redirect:i}];function d(){t()||n()}return{routes:c,beforeEach:d}}const et={user:null},tt={SET_USER(t,e){t.user=e}};var V=E({SET_ERROR(t,e){t.error=e},LOADED_DISHES(t,e){t.dishes=e.dishes},LOADED_INGREDIENTS(t,e){t.ingredients=e.ingredients}},tt);async function nt(){return await O("get","/dishes")}async function st(){return await O("get","/ingredients")}function I(t,e){return async(n,...o)=>{try{await t(n,...o)}catch(s){s instanceof G?(n.commit(g.SET_USER,null),n.commit(g.SET_ERROR,{message:"Bitte melde dich zun\xE4chst an!",link:"/login"})):n.dispatch(w.ERROR_OCCURED,{message:e,details:s})}}}var Z={ERROR_OCCURED(t,e){t.commit(g.SET_ERROR,e)},CLEAR_ERROR(t){t.commit(g.SET_ERROR,null)},LOAD_DISHES:I(async t=>t.commit(g.LOADED_DISHES,await nt()),"Rezepte konnten nicht geladen werden"),LOAD_INGREDIENTS:I(async t=>t.commit(g.LOADED_INGREDIENTS,await st()),"Zutaten konnten nicht geladen werden"),REGISTER_USER:I(async(t,e)=>t.commit(g.SET_USER,await Je(e)),"Die Registrierung war leider nicht erfolgreich. Bitte noch einmal probieren!"),LOGOUT:I(async t=>{await Xe(),t.commit(g.SET_USER,null)},"Logout fehlgeschlagen")},ot={};const rt=E({error:null,dishes:[],ingredients:[]},et),P=re({strict:{}.NODE_ENV!=="production",state:rt,mutations:V,actions:Z,getters:ot});function W(t){return Object.assign({},...Object.keys(t).map(e=>({[e]:e})))}const g=W(V),w=W(Z);function x(){return ie()}const it={class:"navbar-start"},at=p(" Recipes "),ct={class:"navbar-end"},ut={class:"navbar-item"},lt={class:"buttons"},_t=p(" Registrieren "),dt=p("Abmelden"),pt=b({props:{open:null},setup(t){const e=t,n=x(),o=D(()=>"navbar-menu"+(e.open?" is-active":""));return(s,i)=>{const c=$("router-link");return u(),_("div",{id:"navbar",class:ae(l(o))},[r("div",it,[h(c,{class:"navbar-item",to:"/recipes"},{default:m(()=>[at]),_:1})]),r("div",ct,[r("div",ut,[r("div",lt,[l(n).state.user?(u(),T(c,{key:1,to:"/logout",class:"button is-light"},{default:m(()=>[dt]),_:1})):(u(),T(c,{key:0,to:"/register",class:"button is-primary"},{default:m(()=>[_t]),_:1}))])])])],2)}}});var ht=C(pt,[["__scopeId","data-v-40eac8f2"]]);const mt={key:0,class:"error-container"},ft={key:1},gt=b({setup(t){const e=x(),n=D(()=>e.state.error);function o(){e.dispatch(w.CLEAR_ERROR)}return(s,i)=>{const c=$("router-link");return l(n)?(u(),_("div",mt,[r("span",{onClick:o},"\xD7"),l(n).link?(u(),T(c,{key:0,to:l(n).link,onClick:o},{default:m(()=>[p(k(l(n).message),1)]),_:1},8,["to"])):(u(),_("span",ft,k(l(n).message),1))])):A("",!0)}}});var vt=C(gt,[["__scopeId","data-v-3b9f5b22"]]);const yt={class:"navbar-brand"},kt=r("h1",{class:"title"},"Homagix",-1),bt={key:0,class:"username"},Et=["onClick"],$t=r("span",{"aria-hidden":"true"},null,-1),Rt=r("span",{"aria-hidden":"true"},null,-1),St=r("span",{"aria-hidden":"true"},null,-1),Ct=[$t,Rt,St],xt=b({setup(t){const e=x();D(()=>e==null?void 0:e.state.error);const n=F(!1);e.dispatch(w.LOAD_DISHES),e.dispatch(w.LOAD_INGREDIENTS);function o(i){i.target&&(n.value=!n.value)}function s(){n.value=!1}return(i,c)=>{const d=$("router-link"),a=$("router-view");return u(),_(v,null,[r("nav",{class:"navbar is-warning",role:"navigation","aria-label":"main navigation",onClick:s},[r("div",yt,[h(d,{to:"/",class:"navbar-item"},{default:m(()=>[kt]),_:1}),l(e).state.user?(u(),_("div",bt,k(l(e).state.user.name),1)):A("",!0),r("a",{role:"button",class:"navbar-burger","aria-label":"menu","aria-expanded":"false",onClick:ce(o,["stop"])},Ct,8,Et)]),h(ht,{open:n.value},null,8,["open"])]),h(vt),r("section",{class:"section",onClick:s},[h(a)])],64)}}});const wt=t=>(ue("data-v-71246241"),t=t(),le(),t),Dt=wt(()=>r("div",{class:"title is-4"},"Rezepte",-1)),Ot={id:"recipes-list"},It=["onClick"],At=b({setup(t){const e=x(),n=S(),o=D(()=>{var c;const i=(c=e.state.dishes)==null?void 0:c.filter(d=>!d.alwaysOnList);return i==null?void 0:i.sort((d,a)=>d.name.localeCompare(a.name))});function s(i){n.push({name:"recipe",params:{id:i}})}return(i,c)=>{const d=$("o-icon");return u(),_(v,null,[Dt,r("ul",Ot,[(u(!0),_(v,null,H(l(o),a=>(u(),_("li",{key:a.id,onClick:()=>s(a.id)},[h(d,{icon:"utensils"}),p(" "+k(a.name),1)],8,It))),128))])],64)}}});var Lt=C(At,[["__scopeId","data-v-71246241"]]);const Tt={key:0},Nt={class:"title is-4"},Ut=["src"],zt={class:"wrapper",id:"ingredient-list"},Bt={class:"number"},Pt=p("Zur\xFCck"),Ft=b({setup(t){const e=x(),n=_e(),o=S(),s=D(()=>e.state.dishes.find(a=>a.id===n.params.id));function i(){var a;return(a=s.value)==null?void 0:a.items.map(f=>{var y;return z(E({},(y=e.state.ingredients)==null?void 0:y.find(q=>q.id===f.id)),{amount:f.amount})})}function c(){o.push({name:"recipes"})}function d(a){return qe(a.image)}return(a,f)=>l(s)?(u(),_("section",Tt,[r("div",Nt,k(l(s).name),1),l(s).image?(u(),_("img",{key:0,src:d(l(s))},null,8,Ut)):A("",!0),r("div",zt,[(u(!0),_(v,null,H(i(),y=>(u(),_(v,{key:y.id},[r("span",Bt,k(y.amount),1),r("span",null,k(y.unit),1),r("span",null,k(y.name),1)],64))),128))]),r("p",null,k(l(s).recipe),1),h(R,{onClick:c},{default:m(()=>[Pt]),_:1})])):A("",!0)}});var Ht=C(Ft,[["__scopeId","data-v-43dbb0a0"]]);const jt={},Mt=r("div",{class:"title is-4"},"Hast du dich verirrt?",-1),Gt=r("p",null,"Die angeforderte Seite existiert leider nicht.",-1),Vt=p("Bring mich in Sicherheit!");function Zt(t,e){const n=$("router-link");return u(),_(v,null,[Mt,Gt,h(n,{to:"/"},{default:m(()=>[Vt]),_:1})],64)}var Wt=C(jt,[["render",Zt]]),qt=t=>{const e=Ye(()=>t.state.user,[ve(7200),ye(Ke),ke(t)]),n=de({history:pe("/homagix-frontend/"),routes:[{name:"home",path:"/",redirect:"/recipes"},{name:"recipes",path:"/recipes",component:Lt},{name:"recipe",path:"/recipes/:id",component:Ht},...e.routes,{path:"/:pathMatch(.*)*",component:Wt}]});return n.beforeEach(e.beforeEach),n};he(xt).use(P).use(qt(P)).use(me,E({customIconPacks:{fas:{sizes:{default:"",small:"fa-sm",medium:"fa-lg",large:"fa-2x"}}},iconPack:"fas"},fe.exports.bulmaConfig)).mount("#app");
