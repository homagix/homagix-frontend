var G=Object.defineProperty,V=Object.defineProperties;var Z=Object.getOwnPropertyDescriptors;var T=Object.getOwnPropertySymbols;var M=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var A=(t,e,s)=>e in t?G(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,$=(t,e)=>{for(var s in e||(e={}))M.call(e,s)&&A(t,s,e[s]);if(T)for(var s of T(e))W.call(e,s)&&A(t,s,e[s]);return t},N=(t,e)=>V(t,Z(e));import{c as q,u as K,d as k,r as b,o as u,a as l,b as d,e as J,w as g,f as w,g as p,t as R,h as f,i as L,j as r,F as y,k as E,l as B,p as Q,m as X,n as Y,q as ee,s as te,v as ne,x as se,y as oe,z as re,A as ie,B as ce,C as ae}from"./vendor.21aa74ab.js";const ue=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const _ of i.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&o(_)}).observe(document,{childList:!0,subtree:!0});function s(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerpolicy&&(i.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?i.credentials="include":n.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(n){if(n.ep)return;n.ep=!0;const i=s(n);fetch(n.href,i)}};ue();const _e={user:null},le={SET_USER(t,e){t.user=e}};var F=$({SET_ERROR(t,e){t.error=e},LOADED_DISHES(t,e){t.dishes=e.dishes},LOADED_INGREDIENTS(t,e){t.ingredients=e.ingredients}},le);const z=localStorage.getItem("basePath")||"https://homagix-server.dilab.co";function de(t){return z+"/images/"+t}async function D(t,e,s={},o={}){var _;["post","put","patch"].includes(t.toLowerCase())&&Object.keys(s).length?(o.body=JSON.stringify(s),o.headers=N($({},o.headers||{}),{"Content-Type":"application/json"})):Object.keys(s).length&&(e+=`?${new URLSearchParams(s).toString()}`),o.method=t;const n=await fetch(z+e,o),i=(_=n.headers.get("content-type"))!=null&&_.match(/json/)?await n.json():await n.text();if(!n.ok){const a={message:`${t} ${e} -> ${n.status}`,details:{request:`${t} ${e}`,status:n.status,content:i}};throw console.error(a),a}return i}async function pe(){return await D("get","/dishes")}async function he(){return await D("get","/ingredients")}async function me(t){return await D("post","/accounts",{firstName:t})}async function fe(t,e){return await D("get","/accounts/"+t+"/access-codes/"+e)}async function ge(){return await D("delete","/session")}function O(t,e){return async(s,...o)=>{try{await t(s,...o)}catch(n){s.dispatch(S.ERROR_OCCURED,{message:e,details:n})}}}var P={ERROR_OCCURED(t,e){t.commit(v.SET_ERROR,e)},CLEAR_ERROR(t){t.commit(v.SET_ERROR,null)},LOAD_DISHES:O(async t=>t.commit(v.LOADED_DISHES,await pe()),"Rezepte konnten nicht geladen werden"),LOAD_INGREDIENTS:O(async t=>t.commit(v.LOADED_INGREDIENTS,await he()),"Zutaten konnten nicht geladen werden"),REGISTER_USER:O(async(t,e)=>t.commit(v.SET_USER,await me(e)),"Die Registrierung war leider nicht erfolgreich. Bitte noch einmal probieren!"),LOGOUT:O(async t=>{await ge(),t.commit(v.SET_USER,null)},"Logout fehlgeschlagen")},ye={};const ve=$({error:null,dishes:[],ingredients:[]},_e),U=q({strict:{}.NODE_ENV!=="production",state:ve,mutations:F,actions:P,getters:ye});function j(t){return Object.assign({},...Object.keys(t).map(e=>({[e]:e})))}const v=j(F),S=j(P);function x(){return K()}const Re={id:"navigation"},ke=p("Registrieren"),Ee={key:1},$e=p("Logout"),Se=k({setup(t){const e=x();return(s,o)=>{const n=b("router-link");return u(),l("div",Re,[d(e).state.user?w("",!0):(u(),J(n,{key:0,to:"/register"},{default:g(()=>[ke]),_:1})),d(e).state.user?(u(),l("div",Ee,[p(R(d(e).state.user.name)+" ",1),f(n,{to:"/logout"},{default:g(()=>[$e]),_:1})])):w("",!0)])}}});const be={class:"title"},we=p("Homagix"),Ce={key:0,class:"error-container"},De={class:"content"},xe=k({setup(t){const e=x(),s=L(()=>e==null?void 0:e.state.error);e.dispatch(S.LOAD_DISHES),e.dispatch(S.LOAD_INGREDIENTS);function o(){e.dispatch(S.CLEAR_ERROR)}return(n,i)=>{const _=b("router-link"),a=b("router-view");return u(),l(y,null,[r("div",be,[r("h1",null,[f(_,{to:"/"},{default:g(()=>[we]),_:1})]),f(Se)]),d(s)?(u(),l("div",Ce,[r("span",{onClick:o},"\xD7"),p(" "+R(d(s).message),1)])):w("",!0),r("div",De,[f(a)])],64)}}});var I=(t,e)=>{const s=t.__vccOpts||t;for(const[o,n]of e)s[o]=n;return s};const Oe=t=>(Q("data-v-4c630fe6"),t=t(),X(),t),Le=Oe(()=>r("h2",null,"Rezepte",-1)),Ie={id:"recipes-list"},Ne=["onClick"],Te=k({setup(t){const e=x();L(()=>e.state.dishes);const s=E(),o=L(()=>{var _;const i=(_=e.state.dishes)==null?void 0:_.filter(a=>!a.alwaysOnList);return i==null?void 0:i.sort((a,c)=>a.name.localeCompare(c.name))});function n(i){s.push({name:"recipe",params:{id:i}})}return(i,_)=>(u(),l(y,null,[Le,r("ul",Ie,[(u(!0),l(y,null,B(d(o),a=>(u(),l("li",{key:a.id,onClick:()=>n(a.id)},R(a.name),9,Ne))),128))])],64))}});var Ae=I(Te,[["__scopeId","data-v-4c630fe6"]]);const Ue={key:0},Be=["src"],Fe={class:"wrapper",id:"ingredient-list"},ze={class:"number"},Pe=k({setup(t){const e=x(),s=Y(),o=E(),n=L(()=>e.state.dishes.find(c=>c.id===s.params.id));function i(){var c;return(c=n.value)==null?void 0:c.items.map(m=>{var h;return N($({},(h=e.state.ingredients)==null?void 0:h.find(H=>H.id===m.id)),{amount:m.amount})})}function _(){o.push({name:"recipes"})}function a(c){return de(c.image)}return(c,m)=>d(n)?(u(),l("section",Ue,[r("h2",null,R(d(n).name),1),d(n).image?(u(),l("img",{key:0,src:a(d(n))},null,8,Be)):w("",!0),r("div",Fe,[(u(!0),l(y,null,B(i(),h=>(u(),l(y,{key:h.id},[r("span",ze,R(h.amount),1),r("span",null,R(h.unit),1),r("span",null,R(h.name),1)],64))),128))]),r("p",null,R(d(n).recipe),1),r("button",{onClick:_},"Zur\xFCck")])):w("",!0)}});var je=I(Pe,[["__scopeId","data-v-acf19428"]]);const He={},Ge=r("h2",null,"Hast du dich verirrt?",-1),Ve=r("p",null,"Die angeforderte Seite existiert leider nicht.",-1),Ze=p("Bring mich in Sicherheit!");function Me(t,e){const s=b("router-link");return u(),l(y,null,[Ge,Ve,f(s,{to:"/"},{default:g(()=>[Ze]),_:1})],64)}var We=I(He,[["render",Me]]);const qe={};function Ke(t,e){return u(),l("button",null,[ee(t.$slots,"default",{},void 0,!0)])}var C=I(qe,[["render",Ke],["__scopeId","data-v-4e04e4f1"]]);const Je=r("h2",null,"Neu registrieren",-1),Qe=r("p",null," Hier kannst du deinem Zugang einen Namen (z.B. deinen Vornamen oder auch einen Phantasienamen) geben. Wir sprechen dich dann k\xFCnftig damit an. ",-1),Xe=p(" Name "),Ye={class:"button-list"},et=p("Registrieren"),tt=p("Abbrechen"),nt=k({setup(t){const e=E(),s=x();let o=te("");async function n(){await s.dispatch(S.REGISTER_USER,o.value),e.push("/my")}function i(){e.back()}return(_,a)=>(u(),l(y,null,[Je,Qe,r("label",null,[Xe,ne(r("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=c=>oe(o)?o.value=c:o=c)},null,512),[[se,d(o)]])]),r("div",Ye,[f(C,{id:"register-button",onClick:n},{default:g(()=>[et]),_:1}),f(C,{id:"cancel-button",onClick:i},{default:g(()=>[tt]),_:1})])],64))}});const st=r("h2",null,"Willkommen!",-1),ot=r("p",null," Du bist bereits registriert? Um deine Daten zu sch\xFCtzen, musst du den Bookmark verwenden, den du nach der Registrierung erhalten hast. ",-1),rt=p("Du willst dich neu registrieren? Dann geht's "),it=p("hier entlang"),ct={class:"button-list"},at=p("Abbrechen"),ut=k({setup(t){const e=E();return(s,o)=>{const n=b("router-link");return u(),l(y,null,[st,ot,r("p",null,[rt,f(n,{to:"/register"},{default:g(()=>[it]),_:1})]),r("div",ct,[f(C,{onClick:d(e).back},{default:g(()=>[at]),_:1},8,["onClick"])])],64)}}});const _t=r("h2",null,"Ciao!",-1),lt=r("p",null,"Wir hoffen, Dich bald wiederzusehen!",-1),dt={class:"button-list"},pt=p("Zu den Rezepten"),ht=k({setup(t){const e=E();return(s,o)=>(u(),l(y,null,[_t,lt,r("div",dt,[f(C,{id:"recipes-button",onClick:o[0]||(o[0]=n=>d(e).push("/recipes"))},{default:g(()=>[pt]),_:1})])],64))}}),mt=r("h2",null,"Dein Zugang",-1),ft=r("p",null," Speichere diese Seite als Bookmark oder Favorit, dann kommst du einfach wieder hierher zur\xFCck, ohne dich einloggen zu m\xFCssen. ",-1),gt=r("p",null,"Da jede:r mit dem Bookmark hierher kommt, solltest du diesen Link nicht an andere weiter geben.",-1),yt={class:"button-list"},vt=p("Zu den Rezepten"),Rt=k({setup(t){const e=E();function s(){e.push("/recipes")}return(o,n)=>(u(),l(y,null,[mt,ft,gt,r("div",yt,[f(C,{id:"recipes-button",onClick:s},{default:g(()=>[vt]),_:1})])],64))}});function kt(t){function e(c,m){document.cookie=`token=${c};path=/homagix-frontend/;max-age=${m}`}function s(){const c=document.cookie.match(/token=([\w.]+)/);if((c==null?void 0:c.length)===2){const{sub:m,firstName:h}=re(c[1]);return{id:m,name:h}}return null}function o(){e("",-1),t.commit(v.SET_USER,null)}async function n(c){try{const{token:m}=await fe(c.params.id,c.params.code);if(m){e(m,7200);const h=s();return h&&(h.accessCode=c.params.code),t.commit(v.SET_USER,h),!0}}catch(m){console.error(m)}return"/login"}function i(){return t.state.user?"/user/"+t.state.user.id+"/"+t.state.user.accessCode:"/login"}const _=[{path:"/register",component:nt},{path:"/login",component:ut},{path:"/logout",component:ht,beforeEnter:o},{path:"/user/:id/:code",component:Rt,beforeEnter:n},{path:"/my",redirect:i}];function a(){if(!t.state.user){const c=s();c&&t.commit(v.SET_USER,c)}}return{routes:_,beforeEach:a}}var Et=t=>{const e=kt(t),s=ie({history:ce("/homagix-frontend/"),routes:[{name:"home",path:"/",redirect:"/recipes"},{name:"recipes",path:"/recipes",component:Ae},{name:"recipe",path:"/recipes/:id",component:je},...e.routes,{path:"/:pathMatch(.*)*",component:We}]});return s.beforeEach(e.beforeEach),s};ae(xe).use(U).use(Et(U)).mount("#app");
