var ce=Object.defineProperty,ue=Object.defineProperties;var le=Object.getOwnPropertyDescriptors;var V=Object.getOwnPropertySymbols;var de=Object.prototype.hasOwnProperty,_e=Object.prototype.propertyIsEnumerable;var B=(t,e,n)=>e in t?ce(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,D=(t,e)=>{for(var n in e||(e={}))de.call(e,n)&&B(t,n,e[n]);if(V)for(var n of V(e))_e.call(e,n)&&B(t,n,e[n]);return t},W=(t,e)=>ue(t,le(e));var Z=(t,e,n)=>(B(t,typeof e!="symbol"?e+"":e,n),n);import{o as pe,a as d,c as p,r as he,d as E,u as O,b as M,e as o,w as me,v as fe,f as l,i as ve,g as h,h as v,F as b,j as f,k as $,l as ge,m as ye,n as R,p as P,q as H,s as ke,t as be,x as k,y as I,z as X,A as Y,B as ee,C as K,D as Ee,E as $e,G as Re,H as Ce,O as Se,I as we}from"./vendor.11584f90.js";const xe=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerpolicy&&(a.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?a.credentials="include":s.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}};xe();function De(t=7200){return e=>{document.cookie=`token=${e};path=/homagix-frontend/;max-age=${e?t:-1}`}}function Oe(t){return e=>t(e?`Bearer ${e}`:void 0)}function Ae(t){return e=>{var r,s;const n=(r=t.state.user)==null?void 0:r.id;if(e){const{sub:a,firstName:u,accessCode:_}=pe(e);t.commit(y.SET_USER,{id:a,name:u,accessCode:_})}else t.commit(y.SET_USER,null);n!==((s=t.state.user)==null?void 0:s.id)&&t.dispatch(C.LOAD_DATA)}}var S=(t,e)=>{const n=t.__vccOpts||t;for(const[r,s]of e)n[r]=s;return n};const Ie={};function Le(t,e){return d(),p("button",null,[he(t.$slots,"default",{},void 0,!0)])}var L=S(Ie,[["render",Le],["__scopeId","data-v-4e04e4f1"]]);const Te=o("h2",{class:"title is-4"},"Neu registrieren",-1),Fe=o("p",null," Hier kannst du deinem Zugang einen Namen (z.B. deinen Vornamen oder auch einen Phantasienamen) geben. Wir sprechen dich dann k\xFCnftig damit an. ",-1),Ne=f(" Name "),Ue={class:"button-list"},ze=f("Registrieren"),Be=f("Abbrechen"),Pe=E({setup(t){const e=O(),n=w();let r=M("");async function s(){await n.dispatch(C.REGISTER_USER,r.value),e.push("/my")}function a(){e.back()}return(u,_)=>(d(),p(b,null,[Te,Fe,o("label",null,[Ne,me(o("input",{type:"text","onUpdate:modelValue":_[0]||(_[0]=c=>ve(r)?r.value=c:r=c)},null,512),[[fe,l(r)]])]),o("div",Ue,[h(L,{id:"register-button",onClick:s},{default:v(()=>[ze]),_:1}),h(L,{id:"cancel-button",onClick:a},{default:v(()=>[Be]),_:1})])],64))}});const He=o("h2",{class:"title is-4"},"Willkommen!",-1),Ge=o("p",null," Du bist bereits registriert? Um deine Daten zu sch\xFCtzen, musst du den Bookmark verwenden, den du nach der Registrierung erhalten hast. ",-1),Me=f("Du willst dich neu registrieren? Dann geht's "),je=f("hier entlang"),qe={class:"button-list"},Ve=f("Abbrechen"),We=E({setup(t){const e=O();return(n,r)=>{const s=$("router-link");return d(),p(b,null,[He,Ge,o("p",null,[Me,h(s,{to:"/register"},{default:v(()=>[je]),_:1})]),o("div",qe,[h(L,{onClick:l(e).back},{default:v(()=>[Ve]),_:1},8,["onClick"])])],64)}}});const Ze=o("h2",{class:"title is-4"},"Ciao!",-1),Ke=o("p",null,"Wir hoffen, Dich bald wiederzusehen!",-1),Je={class:"button-list"},Qe=f("Zu den Rezepten"),Xe=E({setup(t){const e=O();return(n,r)=>(d(),p(b,null,[Ze,Ke,o("div",Je,[h(L,{id:"recipes-button",onClick:r[0]||(r[0]=s=>l(e).push("/recipes"))},{default:v(()=>[Qe]),_:1})])],64))}}),Ye=o("h2",{class:"title is-4"},"Dein Zugang",-1),et=o("p",null," Speichere diese Seite als Bookmark oder Favorit, dann kommst du einfach wieder hierher zur\xFCck, ohne dich einloggen zu m\xFCssen. ",-1),tt=o("p",null,"Da jede:r mit dem Bookmark hierher kommt, solltest du diesen Link nicht an andere weiter geben.",-1),nt={class:"button-list"},st=f("Zu den Rezepten"),ot=E({setup(t){const e=O();function n(){e.push("/recipes")}return(r,s)=>(d(),p(b,null,[Ye,et,tt,o("div",nt,[h(L,{id:"recipes-button",onClick:n},{default:v(()=>[st]),_:1})])],64))}}),te=localStorage.getItem("basePath")||"https://homagix-server.dilab.co";class ne extends Error{constructor(e,n){super(e);Z(this,"details");this.details=n}}class se extends ne{constructor(){super("Missing authentication token",{status:401})}}function rt(t){return te+"/images/"+t}const G={"Content-Type":"application/json"};function it(t){t?G.Authorization=t:delete G.Authorization}async function T(t,e,n={},r={}){var u;r.headers=D(D({},G),r.headers||{}),r.method=t.toUpperCase(),["POST","PUT","PATCH"].includes(r.method)&&Object.keys(n).length?r.body=JSON.stringify(n):Object.keys(n).length&&(e+=`?${new URLSearchParams(n).toString()}`);const s=await fetch(te+e,r),a=(u=s.headers.get("content-type"))!=null&&u.match(/json/)?await s.json():await s.text();if(!s.ok){if(s.status===401)throw new se;const _=new ne(`${t} ${e} -> ${s.status}`,{status:s.status,content:a});throw console.error(_),_}return a}async function at(t){return await T("post","/accounts",{firstName:t})}async function ct(t,e){return await T("get","/accounts/"+t+"/access-codes/"+e)}async function ut(){return await T("delete","/session")}function lt(t,e=[]){function n(){const c=document.cookie.match(/token=([\w.]+)/);e.forEach(i=>i(c?c[1]:void 0))}function r(){e.forEach(c=>c())}async function s(c){try{const{token:i}=await ct(c.params.id,c.params.code);if(i)return e.forEach(g=>g(i)),!0}catch(i){console.error(i)}return"/login"}function a(){const c=t();return c?"/user/"+c.id+"/"+c.accessCode:"/login"}const u=[{path:"/register",component:Pe},{path:"/login",component:We},{path:"/logout",component:Xe,beforeEnter:r},{path:"/user/:id/:code",component:ot,beforeEnter:s},{path:"/my",redirect:a}];function _(){t()||n()}return{routes:u,beforeEach:_}}const dt={user:null},_t={SET_USER(t,e){t.user=e}};var oe=D({SET_ERROR(t,e){t.error=e},LOADED_DISHES(t,e){t.dishes=e.dishes},LOADED_INGREDIENTS(t,e){t.ingredients=e.ingredients}},_t);async function pt(){return await T("get","/dishes")}async function ht(t,e){return await T("PATCH",`/dishes/${t}`,{isFavorite:e})}async function mt(){return await T("get","/ingredients")}function N(t,e){return async(n,...r)=>{try{await t(n,...r)}catch(s){s instanceof se?(n.commit(y.SET_USER,null),n.commit(y.SET_ERROR,{message:"Bitte melde dich zun\xE4chst an!",link:"/login"})):n.dispatch(C.ERROR_OCCURED,{message:e,details:s})}}}var re={ERROR_OCCURED(t,e){t.commit(y.SET_ERROR,e)},CLEAR_ERROR(t){t.commit(y.SET_ERROR,null)},LOAD_DATA(t){t.dispatch(C.LOAD_DISHES),t.dispatch(C.LOAD_INGREDIENTS)},LOAD_DISHES:N(async t=>t.commit(y.LOADED_DISHES,await pt()),"Rezepte konnten nicht geladen werden"),LOAD_INGREDIENTS:N(async t=>t.commit(y.LOADED_INGREDIENTS,await mt()),"Zutaten konnten nicht geladen werden"),REGISTER_USER:N(async(t,e)=>{t.commit(y.SET_USER,await at(e))},"Die Registrierung war leider nicht erfolgreich. Bitte noch einmal probieren!"),LOGOUT:N(async t=>{await ut(),t.commit(y.SET_USER,null)},"Logout fehlgeschlagen"),TOGGLE_FAVORITE:N(async(t,e)=>{const n=async s=>s.id===e?ht(e,!s.isFavorite):s,r=await Promise.all(t.state.dishes.map(n));t.commit(y.LOADED_DISHES,{dishes:r})},"Rezept konnte nicht als Favorit markiert werden")},ft={};const vt=D({error:null,dishes:[],ingredients:[]},dt),J=ge({strict:{}.NODE_ENV!=="production",state:vt,mutations:oe,actions:re,getters:ft});function ie(t){return Object.assign({},...Object.keys(t).map(e=>({[e]:e})))}const y=ie(oe),C=ie(re);function w(){return ye()}const gt=t=>(ke("data-v-98467ea4"),t=t(),be(),t),yt=gt(()=>o("div",{class:"navbar-start"},null,-1)),kt={class:"navbar-end"},bt={class:"navbar-item"},Et={class:"buttons"},$t=f(" Registrieren "),Rt=f("Abmelden"),Ct=E({props:{open:null},setup(t){const e=t,n=w(),r=R(()=>"navbar-menu"+(e.open?" is-active":""));return(s,a)=>{const u=$("router-link");return d(),p("div",{id:"navbar",class:H(l(r))},[yt,o("div",kt,[o("div",bt,[o("div",Et,[l(n).state.user?(d(),P(u,{key:1,to:"/logout",class:"button is-light"},{default:v(()=>[Rt]),_:1})):(d(),P(u,{key:0,to:"/register",class:"button is-primary"},{default:v(()=>[$t]),_:1}))])])])],2)}}});var St=S(Ct,[["__scopeId","data-v-98467ea4"]]);const wt={key:0,class:"error-container"},xt={key:1},Dt=E({setup(t){const e=w(),n=R(()=>e.state.error);function r(){e.dispatch(C.CLEAR_ERROR)}return(s,a)=>{const u=$("router-link");return l(n)?(d(),p("div",wt,[o("span",{onClick:r},"\xD7"),l(n).link?(d(),P(u,{key:0,to:l(n).link,onClick:r},{default:v(()=>[f(k(l(n).message),1)]),_:1},8,["to"])):(d(),p("span",xt,k(l(n).message),1))])):I("",!0)}}});var Ot=S(Dt,[["__scopeId","data-v-3b9f5b22"]]);const At={class:"navbar-brand"},It=o("h1",{class:"title"},"Homagix",-1),Lt={key:0,class:"username"},Tt=["onClick"],Ft=o("span",{"aria-hidden":"true"},null,-1),Nt=o("span",{"aria-hidden":"true"},null,-1),Ut=o("span",{"aria-hidden":"true"},null,-1),zt=[Ft,Nt,Ut],Bt=E({setup(t){const e=w();R(()=>e==null?void 0:e.state.error);const n=M(!1);e.dispatch(C.LOAD_DATA);function r(a){a.target&&(n.value=!n.value)}function s(){n.value=!1}return(a,u)=>{const _=$("router-link"),c=$("router-view");return d(),p(b,null,[o("nav",{class:"navbar is-warning",role:"navigation","aria-label":"main navigation",onClick:s},[o("div",At,[h(_,{to:"/",class:"navbar-item"},{default:v(()=>[It]),_:1}),l(e).state.user?(d(),p("div",Lt,k(l(e).state.user.name),1)):I("",!0),o("a",{role:"button",class:"navbar-burger","aria-label":"menu","aria-expanded":"false",onClick:X(r,["stop"])},zt,8,Tt)]),h(St,{open:n.value},null,8,["open"])]),h(Ot),o("section",{class:"section",onClick:s},[h(c)])],64)}}});const Pt=["onClick","title"],Ht=E({props:{dish:null},setup(t){const e=t,n=w(),r=R(()=>e.dish.isFavorite?"\u2605":"\u2606"),s=()=>n.dispatch(C.TOGGLE_FAVORITE,e.dish.id),a=e.dish.isFavorite?"Von der Favoritenliste entfernen":"Zur Favoritenliste hinzuf\xFCgen";return(u,_)=>(d(),p("a",{href:"#",class:"favorite",onClick:X(s,["stop"]),title:l(a)},k(l(r)),9,Pt))}});var ae=S(Ht,[["__scopeId","data-v-24becedb"]]);const Gt={class:"title is-4"},Mt=f(" Rezepte "),jt={key:0,class:"filter"},qt={key:0,class:"tabs is-boxed"},Vt=f("Alle"),Wt=f("Favoriten"),Zt={id:"recipes-list"},Kt=["onClick"],Jt=E({props:{onlyFavorites:{type:Boolean}},setup(t){const e=t,n=w(),r=O(),s=Y(),a=R(()=>Object.assign({},...n.state.ingredients.map(m=>({[m.name.toLocaleLowerCase()]:m.id}))));function u(m){return!m.alwaysOnList}function _(m){return!e.onlyFavorites||m.isFavorite}function c(m){const A=s.query.ingredient&&a.value[s.query.ingredient.toLocaleLowerCase()];return!A||m.items.some(x=>x.id===A)}const i=R(()=>{var A;const m=(A=n.state.dishes)==null?void 0:A.filter(u).filter(_).filter(c);return m==null?void 0:m.sort((x,F)=>x.name.localeCompare(F.name))});function g(m){r.push({name:"recipe",params:{id:m}})}function z(){r.push({query:{ingredient:void 0}})}function j(m){return{"is-active":s.path===m}}function q(m){return m+(s.query.ingredient?`?ingredient=${s.query.ingredient}`:"")}return(m,A)=>{const x=$("o-icon"),F=$("router-link");return d(),p(b,null,[o("div",Gt,[Mt,l(s).query.ingredient?(d(),p("div",jt,[f(" mit "+k(l(s).query.ingredient)+" ",1),o("span",{class:"remove",title:"Filter entfernen",onClick:z},[h(x,{icon:"remove"})])])):I("",!0),h(F,{to:{path:"/wordcloud"}},{default:v(()=>[h(x,{icon:"magnifying-glass",class:"wordcloud"})]),_:1})]),l(n).state.user?(d(),p("div",qt,[o("ul",null,[o("li",{class:H(j("/recipes"))},[h(F,{to:q("recipes")},{default:v(()=>[Vt]),_:1},8,["to"])],2),o("li",{class:H(j("/favorites"))},[h(F,{to:q("favorites")},{default:v(()=>[Wt]),_:1},8,["to"])],2)])])):I("",!0),o("ul",Zt,[(d(!0),p(b,null,ee(l(i),U=>(d(),p("li",{key:U.id,onClick:()=>g(U.id)},[h(x,{icon:"utensils"}),f(" "+k(U.name)+" ",1),h(ae,{dish:U},null,8,["dish"])],8,Kt))),128))])],64)}}});var Q=S(Jt,[["__scopeId","data-v-95e70ace"]]);const Qt={key:0},Xt={class:"title is-4"},Yt={class:"image-ingredients"},en=["src"],tn={class:"wrapper"},nn={id:"ingredient-list"},sn={id:"description"},on=f("Zur\xFCck"),rn=E({setup(t){const e=w(),n=Y(),r=O(),s=R(()=>e.state.dishes.find(c=>c.id===n.params.id));function a(){var c;return(c=s.value)==null?void 0:c.items.map(i=>{var g;return W(D({},(g=e.state.ingredients)==null?void 0:g.find(z=>z.id===i.id)),{amount:i.amount})})}function u(){r.push({name:"recipes"})}function _(c){return rt(c.image)}return(c,i)=>l(s)?(d(),p("section",Qt,[o("div",Xt,[o("span",null,k(l(s).name),1),h(ae,{dish:l(s)},null,8,["dish"])]),o("div",Yt,[o("div",null,[l(s).image?(d(),p("img",{key:0,src:_(l(s))},null,8,en)):I("",!0)]),o("div",tn,[o("div",nn,[(d(!0),p(b,null,ee(a(),g=>(d(),p(b,{key:g.id},[o("span",null,k(g.amount),1),o("span",null,k(g.unit),1),o("span",null,k(g.name),1)],64))),128))])])]),o("div",sn,k(l(s).recipe||"Noch gibt es keine Beschreibung zu diesem Gericht"),1),h(L,{onClick:u},{default:v(()=>[on]),_:1})])):I("",!0)}});var an=S(rn,[["__scopeId","data-v-e1cfac68"]]);const cn={class:"button-list"},un=E({setup(t){const e=w(),n=O(),r=["Salz","Pfeffer","Zucker","Butter","Mehl"],s=R(()=>{if(!e.state.ingredients.length)return[];const _=Object.assign({},...e.state.ingredients.map(i=>({[i.id]:{id:i.id,name:i.name,count:0}})));e.state.dishes.flatMap(i=>i.items).forEach(i=>_[i.id].count++);const c=i=>"/recipes?ingredient="+encodeURIComponent(i.name);return Object.values(_).filter(i=>i.count).filter(i=>!r.includes(i.name)).sort((i,g)=>Math.random()-.5).map(i=>_[i.id]).map(i=>[i.name,i.count*6+2,c(i)])}),a=M();function u(){if(s.value.length&&a.value){const _=document.createElement("div"),c=document.createElement("div");c.setAttribute("class","wordcloud-canvas"),_.appendChild(c),a.value.innerHTML="",a.value.appendChild(_),Ee(c,{list:s.value,shape:"square",click(i){n.push(i[2])}})}}return K(s,u),K(u,()=>{}),(_,c)=>{const i=$("o-icon");return d(),p(b,null,[o("div",cn,[o("a",{onClick:c[0]||(c[0]=()=>l(n).back())},[h(i,{icon:"close"})])]),o("div",{class:"wordcloud",ref_key:"canvas",ref:a},null,512)],64)}}});var ln=S(un,[["__scopeId","data-v-4b74e270"]]);const dn={},_n=o("div",{class:"title is-4"},"Hast du dich verirrt?",-1),pn=o("p",null,"Die angeforderte Seite existiert leider nicht.",-1),hn=f("Bring mich in Sicherheit!");function mn(t,e){const n=$("router-link");return d(),p(b,null,[_n,pn,h(n,{to:"/"},{default:v(()=>[hn]),_:1})],64)}var fn=S(dn,[["render",mn]]),vn=t=>{const e=lt(()=>t.state.user,[De(7200),Oe(it),Ae(t)]),n=$e({history:Re("/homagix-frontend/"),routes:[{name:"home",path:"/",redirect:"/recipes"},{name:"recipes",path:"/recipes",component:Q},{name:"favorites",path:"/favorites",component:Q,props:{onlyFavorites:!0}},{name:"recipe",path:"/recipes/:id",component:an},{name:"wordcloud",path:"/wordcloud",component:ln},...e.routes,{path:"/:pathMatch(.*)*",component:fn}]});return n.beforeEach(e.beforeEach),n};Ce(Bt).use(J).use(vn(J)).use(Se,D({customIconPacks:{fas:{sizes:{default:"",small:"fa-sm",medium:"fa-lg",large:"fa-2x"}}},iconPack:"fas"},we.exports.bulmaConfig)).mount("#app");
