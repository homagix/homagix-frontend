var Y=Object.defineProperty,ee=Object.defineProperties;var te=Object.getOwnPropertyDescriptors;var F=Object.getOwnPropertySymbols;var ne=Object.prototype.hasOwnProperty,se=Object.prototype.propertyIsEnumerable;var U=(t,e,n)=>e in t?Y(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,R=(t,e)=>{for(var n in e||(e={}))ne.call(e,n)&&U(t,n,e[n]);if(F)for(var n of F(e))se.call(e,n)&&U(t,n,e[n]);return t},M=(t,e)=>ee(t,te(e));var j=(t,e,n)=>(U(t,typeof e!="symbol"?e+"":e,n),n);import{o as oe,a as l,c as p,r as re,d as E,u as w,b as P,e as r,w as ie,v as ae,f as _,i as ce,g as h,h as g,F as y,j as f,k as $,l as ue,m as le,n as C,p as z,q as de,t as b,s as A,x as _e,y as G,z as W,A as H,B as pe,C as he,D as me,E as fe,O as ge,G as ve}from"./vendor.41e89399.js";const ye=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const c of s)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function n(s){const c={};return s.integrity&&(c.integrity=s.integrity),s.referrerpolicy&&(c.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?c.credentials="include":s.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(s){if(s.ep)return;s.ep=!0;const c=n(s);fetch(s.href,c)}};ye();function ke(t=7200){return e=>{document.cookie=`token=${e};path=/homagix-frontend/;max-age=${e?t:-1}`}}function be(t){return e=>t(e?`Bearer ${e}`:void 0)}function Ee(t){return e=>{if(e){const{sub:n,firstName:i,accessCode:s}=oe(e);t.commit(k.SET_USER,{id:n,name:i,accessCode:s})}else t.commit(k.SET_USER,null)}}var S=(t,e)=>{const n=t.__vccOpts||t;for(const[i,s]of e)n[i]=s;return n};const $e={};function Re(t,e){return l(),p("button",null,[re(t.$slots,"default",{},void 0,!0)])}var D=S($e,[["render",Re],["__scopeId","data-v-4e04e4f1"]]);const Ce=r("h2",{class:"title is-4"},"Neu registrieren",-1),we=r("p",null," Hier kannst du deinem Zugang einen Namen (z.B. deinen Vornamen oder auch einen Phantasienamen) geben. Wir sprechen dich dann k\xFCnftig damit an. ",-1),Se=f(" Name "),xe={class:"button-list"},De=f("Registrieren"),Oe=f("Abbrechen"),Ae=E({setup(t){const e=w(),n=x();let i=P("");async function s(){await n.dispatch(O.REGISTER_USER,i.value),e.push("/my")}function c(){e.back()}return(u,d)=>(l(),p(y,null,[Ce,we,r("label",null,[Se,ie(r("input",{type:"text","onUpdate:modelValue":d[0]||(d[0]=a=>ce(i)?i.value=a:i=a)},null,512),[[ae,_(i)]])]),r("div",xe,[h(D,{id:"register-button",onClick:s},{default:g(()=>[De]),_:1}),h(D,{id:"cancel-button",onClick:c},{default:g(()=>[Oe]),_:1})])],64))}});const Le=r("h2",{class:"title is-4"},"Willkommen!",-1),Ie=r("p",null," Du bist bereits registriert? Um deine Daten zu sch\xFCtzen, musst du den Bookmark verwenden, den du nach der Registrierung erhalten hast. ",-1),Te=f("Du willst dich neu registrieren? Dann geht's "),Ne=f("hier entlang"),Ue={class:"button-list"},ze=f("Abbrechen"),Be=E({setup(t){const e=w();return(n,i)=>{const s=$("router-link");return l(),p(y,null,[Le,Ie,r("p",null,[Te,h(s,{to:"/register"},{default:g(()=>[Ne]),_:1})]),r("div",Ue,[h(D,{onClick:_(e).back},{default:g(()=>[ze]),_:1},8,["onClick"])])],64)}}});const Pe=r("h2",{class:"title is-4"},"Ciao!",-1),Fe=r("p",null,"Wir hoffen, Dich bald wiederzusehen!",-1),Me={class:"button-list"},je=f("Zu den Rezepten"),He=E({setup(t){const e=w();return(n,i)=>(l(),p(y,null,[Pe,Fe,r("div",Me,[h(D,{id:"recipes-button",onClick:i[0]||(i[0]=s=>_(e).push("/recipes"))},{default:g(()=>[je]),_:1})])],64))}}),qe=r("h2",{class:"title is-4"},"Dein Zugang",-1),Ge=r("p",null," Speichere diese Seite als Bookmark oder Favorit, dann kommst du einfach wieder hierher zur\xFCck, ohne dich einloggen zu m\xFCssen. ",-1),We=r("p",null,"Da jede:r mit dem Bookmark hierher kommt, solltest du diesen Link nicht an andere weiter geben.",-1),Ve={class:"button-list"},Ze=f("Zu den Rezepten"),Ke=E({setup(t){const e=w();function n(){e.push("/recipes")}return(i,s)=>(l(),p(y,null,[qe,Ge,We,r("div",Ve,[h(D,{id:"recipes-button",onClick:n},{default:g(()=>[Ze]),_:1})])],64))}}),V=localStorage.getItem("basePath")||"https://homagix-server.dilab.co";class Z extends Error{constructor(e,n){super(e);j(this,"details");this.details=n}}class K extends Z{constructor(){super("Missing authentication token",{status:401})}}function Je(t){return V+"/images/"+t}const B={"Content-Type":"application/json"};function Qe(t){t?B.Authorization=t:delete B.Authorization}async function L(t,e,n={},i={}){var u;i.headers=R(R({},B),i.headers||{}),i.method=t.toUpperCase(),["POST","PUT","PATCH"].includes(i.method)&&Object.keys(n).length?i.body=JSON.stringify(n):Object.keys(n).length&&(e+=`?${new URLSearchParams(n).toString()}`);const s=await fetch(V+e,i),c=(u=s.headers.get("content-type"))!=null&&u.match(/json/)?await s.json():await s.text();if(!s.ok){if(s.status===401)throw new K;const d=new Z(`${t} ${e} -> ${s.status}`,{status:s.status,content:c});throw console.error(d),d}return c}async function Xe(t){return await L("post","/accounts",{firstName:t})}async function Ye(t,e){return await L("get","/accounts/"+t+"/access-codes/"+e)}async function et(){return await L("delete","/session")}function tt(t,e=[]){function n(){const a=document.cookie.match(/token=([\w.]+)/);e.forEach(o=>o(a?a[1]:void 0))}function i(){e.forEach(a=>a())}async function s(a){try{const{token:o}=await Ye(a.params.id,a.params.code);if(o)return e.forEach(m=>m(o)),!0}catch(o){console.error(o)}return"/login"}function c(){const a=t();return a?"/user/"+a.id+"/"+a.accessCode:"/login"}const u=[{path:"/register",component:Ae},{path:"/login",component:Be},{path:"/logout",component:He,beforeEnter:i},{path:"/user/:id/:code",component:Ke,beforeEnter:s},{path:"/my",redirect:c}];function d(){t()||n()}return{routes:u,beforeEach:d}}const nt={user:null},st={SET_USER(t,e){t.user=e}};var J=R({SET_ERROR(t,e){t.error=e},LOADED_DISHES(t,e){t.dishes=e.dishes},LOADED_INGREDIENTS(t,e){t.ingredients=e.ingredients}},st);async function ot(){return await L("get","/dishes")}async function rt(){return await L("get","/ingredients")}function I(t,e){return async(n,...i)=>{try{await t(n,...i)}catch(s){s instanceof K?(n.commit(k.SET_USER,null),n.commit(k.SET_ERROR,{message:"Bitte melde dich zun\xE4chst an!",link:"/login"})):n.dispatch(O.ERROR_OCCURED,{message:e,details:s})}}}var Q={ERROR_OCCURED(t,e){t.commit(k.SET_ERROR,e)},CLEAR_ERROR(t){t.commit(k.SET_ERROR,null)},LOAD_DATA(t){t.dispatch(O.LOAD_DISHES),t.dispatch(O.LOAD_INGREDIENTS)},LOAD_DISHES:I(async t=>t.commit(k.LOADED_DISHES,await ot()),"Rezepte konnten nicht geladen werden"),LOAD_INGREDIENTS:I(async t=>t.commit(k.LOADED_INGREDIENTS,await rt()),"Zutaten konnten nicht geladen werden"),REGISTER_USER:I(async(t,e)=>t.commit(k.SET_USER,await Xe(e)),"Die Registrierung war leider nicht erfolgreich. Bitte noch einmal probieren!"),LOGOUT:I(async t=>{await et(),t.commit(k.SET_USER,null)},"Logout fehlgeschlagen")},it={};const at=R({error:null,dishes:[],ingredients:[]},nt),q=ue({strict:{}.NODE_ENV!=="production",state:at,mutations:J,actions:Q,getters:it});function X(t){return Object.assign({},...Object.keys(t).map(e=>({[e]:e})))}const k=X(J),O=X(Q);function x(){return le()}const ct={class:"navbar-start"},ut=f(" Recipes "),lt={class:"navbar-end"},dt={class:"navbar-item"},_t={class:"buttons"},pt=f(" Registrieren "),ht=f("Abmelden"),mt=E({props:{open:null},setup(t){const e=t,n=x(),i=C(()=>"navbar-menu"+(e.open?" is-active":""));return(s,c)=>{const u=$("router-link");return l(),p("div",{id:"navbar",class:de(_(i))},[r("div",ct,[h(u,{class:"navbar-item",to:"/recipes"},{default:g(()=>[ut]),_:1})]),r("div",lt,[r("div",dt,[r("div",_t,[_(n).state.user?(l(),z(u,{key:1,to:"/logout",class:"button is-light"},{default:g(()=>[ht]),_:1})):(l(),z(u,{key:0,to:"/register",class:"button is-primary"},{default:g(()=>[pt]),_:1}))])])])],2)}}});var ft=S(mt,[["__scopeId","data-v-40eac8f2"]]);const gt={key:0,class:"error-container"},vt={key:1},yt=E({setup(t){const e=x(),n=C(()=>e.state.error);function i(){e.dispatch(O.CLEAR_ERROR)}return(s,c)=>{const u=$("router-link");return _(n)?(l(),p("div",gt,[r("span",{onClick:i},"\xD7"),_(n).link?(l(),z(u,{key:0,to:_(n).link,onClick:i},{default:g(()=>[f(b(_(n).message),1)]),_:1},8,["to"])):(l(),p("span",vt,b(_(n).message),1))])):A("",!0)}}});var kt=S(yt,[["__scopeId","data-v-3b9f5b22"]]);const bt={class:"navbar-brand"},Et=r("h1",{class:"title"},"Homagix",-1),$t={key:0,class:"username"},Rt=["onClick"],Ct=r("span",{"aria-hidden":"true"},null,-1),wt=r("span",{"aria-hidden":"true"},null,-1),St=r("span",{"aria-hidden":"true"},null,-1),xt=[Ct,wt,St],Dt=E({setup(t){const e=x();C(()=>e==null?void 0:e.state.error);const n=P(!1);e.dispatch(O.LOAD_DATA);function i(c){c.target&&(n.value=!n.value)}function s(){n.value=!1}return(c,u)=>{const d=$("router-link"),a=$("router-view");return l(),p(y,null,[r("nav",{class:"navbar is-warning",role:"navigation","aria-label":"main navigation",onClick:s},[r("div",bt,[h(d,{to:"/",class:"navbar-item"},{default:g(()=>[Et]),_:1}),_(e).state.user?(l(),p("div",$t,b(_(e).state.user.name),1)):A("",!0),r("a",{role:"button",class:"navbar-burger","aria-label":"menu","aria-expanded":"false",onClick:_e(i,["stop"])},xt,8,Rt)]),h(ft,{open:n.value},null,8,["open"])]),h(kt),r("section",{class:"section",onClick:s},[h(a)])],64)}}});const Ot={class:"title is-4"},At=f(" Rezepte "),Lt={key:0,class:"filter"},It={id:"recipes-list"},Tt=["onClick"],Nt=E({setup(t){const e=x(),n=w(),i=G(),s=C(()=>Object.assign({},...e.state.ingredients.map(o=>({[o.name.toLocaleLowerCase()]:o.id}))));function c(o){const m=i.query.ingredient&&s.value[i.query.ingredient.toLocaleLowerCase()];return!m||o.items.some(v=>v.id===m)}const u=C(()=>{var m;const o=(m=e.state.dishes)==null?void 0:m.filter(v=>!v.alwaysOnList&&c(v));return o==null?void 0:o.sort((v,T)=>v.name.localeCompare(T.name))});function d(o){n.push({name:"recipe",params:{id:o}})}function a(){n.push({query:{ingredient:void 0}})}return(o,m)=>{const v=$("o-icon"),T=$("router-link");return l(),p(y,null,[r("div",Ot,[At,_(i).query.ingredient?(l(),p("div",Lt,[f(" mit "+b(_(i).query.ingredient)+" ",1),r("span",{class:"remove",title:"Filter entfernen",onClick:a},[h(v,{icon:"remove"})])])):A("",!0),h(T,{to:{path:"/wordcloud"}},{default:g(()=>[h(v,{icon:"magnifying-glass",class:"wordcloud"})]),_:1})]),r("ul",It,[(l(!0),p(y,null,W(_(u),N=>(l(),p("li",{key:N.id,onClick:()=>d(N.id)},[h(v,{icon:"utensils"}),f(" "+b(N.name),1)],8,Tt))),128))])],64)}}});var Ut=S(Nt,[["__scopeId","data-v-56703dd4"]]);const zt={key:0},Bt={class:"title is-4"},Pt={class:"image-ingredients"},Ft=["src"],Mt={class:"wrapper"},jt={id:"ingredient-list"},Ht={id:"description"},qt=f("Zur\xFCck"),Gt=E({setup(t){const e=x(),n=G(),i=w(),s=C(()=>e.state.dishes.find(a=>a.id===n.params.id));function c(){var a;return(a=s.value)==null?void 0:a.items.map(o=>{var m;return M(R({},(m=e.state.ingredients)==null?void 0:m.find(v=>v.id===o.id)),{amount:o.amount})})}function u(){i.push({name:"recipes"})}function d(a){return Je(a.image)}return(a,o)=>_(s)?(l(),p("section",zt,[r("div",Bt,[r("span",null,b(_(s).name),1)]),r("div",Pt,[r("div",null,[_(s).image?(l(),p("img",{key:0,src:d(_(s))},null,8,Ft)):A("",!0)]),r("div",Mt,[r("div",jt,[(l(!0),p(y,null,W(c(),m=>(l(),p(y,{key:m.id},[r("span",null,b(m.amount),1),r("span",null,b(m.unit),1),r("span",null,b(m.name),1)],64))),128))])])]),r("div",Ht,b(_(s).recipe||"Noch gibt es keine Beschreibung zu diesem Gericht"),1),h(D,{onClick:u},{default:g(()=>[qt]),_:1})])):A("",!0)}});var Wt=S(Gt,[["__scopeId","data-v-b1034768"]]);const Vt={class:"button-list"},Zt=E({setup(t){const e=x(),n=w(),i=["Salz","Pfeffer","Zucker","Butter","Mehl"],s=C(()=>{if(!e.state.ingredients.length)return[];const d=Object.assign({},...e.state.ingredients.map(o=>({[o.id]:{id:o.id,name:o.name,count:0}})));e.state.dishes.flatMap(o=>o.items).forEach(o=>d[o.id].count++);const a=o=>"/recipes?ingredient="+encodeURIComponent(o.name);return Object.values(d).filter(o=>o.count).filter(o=>!i.includes(o.name)).sort((o,m)=>Math.random()-.5).map(o=>d[o.id]).map(o=>[o.name,o.count*6+2,a(o)])}),c=P();function u(){if(s.value.length&&c.value){const d=document.createElement("div"),a=document.createElement("div");a.setAttribute("class","wordcloud-canvas"),d.appendChild(a),c.value.innerHTML="",c.value.appendChild(d),pe(a,{list:s.value,shape:"square",click(o){n.push(o[2])}})}}return H(s,u),H(u,()=>{}),(d,a)=>{const o=$("o-icon");return l(),p(y,null,[r("div",Vt,[r("a",{onClick:a[0]||(a[0]=()=>_(n).back())},[h(o,{icon:"close"})])]),r("div",{class:"wordcloud",ref_key:"canvas",ref:c},null,512)],64)}}});var Kt=S(Zt,[["__scopeId","data-v-4b74e270"]]);const Jt={},Qt=r("div",{class:"title is-4"},"Hast du dich verirrt?",-1),Xt=r("p",null,"Die angeforderte Seite existiert leider nicht.",-1),Yt=f("Bring mich in Sicherheit!");function en(t,e){const n=$("router-link");return l(),p(y,null,[Qt,Xt,h(n,{to:"/"},{default:g(()=>[Yt]),_:1})],64)}var tn=S(Jt,[["render",en]]),nn=t=>{const e=tt(()=>t.state.user,[ke(7200),be(Qe),Ee(t)]),n=he({history:me("/homagix-frontend/"),routes:[{name:"home",path:"/",redirect:"/recipes"},{name:"recipes",path:"/recipes",component:Ut},{name:"recipe",path:"/recipes/:id",component:Wt},{name:"wordcloud",path:"/wordcloud",component:Kt},...e.routes,{path:"/:pathMatch(.*)*",component:tn}]});return n.beforeEach(e.beforeEach),n};fe(Dt).use(q).use(nn(q)).use(ge,R({customIconPacks:{fas:{sizes:{default:"",small:"fa-sm",medium:"fa-lg",large:"fa-2x"}}},iconPack:"fas"},ve.exports.bulmaConfig)).mount("#app");
